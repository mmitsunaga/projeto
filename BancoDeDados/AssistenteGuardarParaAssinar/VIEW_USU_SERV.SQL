CREATE OR REPLACE VIEW PROJUDI.VIEW_USU_SERV
AS SELECT 
    US.ID_USU_SERV AS ID_USU_SERV,
    U.USU AS USU_SERV,
    US.ID_USU AS ID_USU,
    U.USU AS USU,
    US.ID_SERV AS ID_SERV,
    S.SERV AS SERV,
    S.ID_COMARCA AS ID_COMARCA,
    C.COMARCA AS COMARCA,
    E.ID_ENDERECO AS ID_ENDERECO_SERV,
    (E.LOGRADOURO || ', N.' || E.NUMERO) AS ENDERECO_SERV,
    E.ID_BAIRRO AS ID_BAIRRO_SERV,
    B.BAIRRO AS BAIRRO_SERV,
    B.ID_CIDADE AS ID_CIDADE_SERV,
    CI.CIDADE AS CIDADE_SERV,
    US.ATIVO AS ATIVO,
    S.SERV_CODIGO AS SERV_CODIGO,
    S.SERV_CODIGO_EXTERNO AS SERV_CODIGO_EXTERNO,
    C.COMARCA_CODIGO AS COMARCA_CODIGO,
    B.BAIRRO_CODIGO AS BAIRRO_CODIGO_SERV,
    CI.CIDADE_CODIGO AS CIDADE_CODIGO_SERV,
    U.NOME AS NOME,
    US.ID_USU_SERV_CHEFE AS ID_USU_SERV_CHEFE,
    U2.NOME AS USU_SERV_CHEFE,
    US.CODIGO_TEMP AS CODIGO_TEMP,
	US.PODE_GUARDAR_ASSINAR_USUCHEFE AS PODE_GUARDAR_ASSINAR_USUCHEFE
  FROM 
    (((((((((USU_SERV US JOIN SERV S ON((US.ID_SERV = S.ID_SERV))) JOIN USU U ON((US.ID_USU = U.ID_USU))) LEFT JOIN COMARCA C ON((S.ID_COMARCA = C.ID_COMARCA))) JOIN ENDERECO E ON((S.ID_ENDERECO = E.ID_ENDERECO))) LEFT JOIN BAIRRO B ON((E.ID_BAIRRO = B.ID_BAIRRO))) JOIN CIDADE CI ON((B.ID_CIDADE = CI.ID_CIDADE))) JOIN ESTADO ES ON((CI.ID_ESTADO = ES.ID_ESTADO))) LEFT JOIN USU_SERV US2 ON((US.ID_USU_SERV_CHEFE = US2.ID_USU_SERV))) LEFT JOIN USU U2 ON((US2.ID_USU = U2.ID_USU)))