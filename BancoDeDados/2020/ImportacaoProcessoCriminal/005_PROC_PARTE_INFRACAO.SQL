CREATE TABLE PROJUDI.PROC_PARTE_INFRACAO
(	
   ID_PROC_PARTE_INFRACAO   NUMBER(24,0)   NOT NULL, 
   ID_PROC_PARTE            NUMBER(24,0)   NOT NULL, 
   ID_INFRACOES             NUMBER(10,0)   NOT NULL,
   LEI	                    VARCHAR2(26 BYTE),
   ARTIGO	                VARCHAR2(26 BYTE),
   PARAGRAFO	            VARCHAR2(26 BYTE),
   INCISO	                VARCHAR2(26 BYTE)
);

CREATE UNIQUE INDEX PROJUDI.PROC_PARTE_INFRACAO_IDX1 ON PROJUDI.PROC_PARTE_INFRACAO (ID_PROC_PARTE_INFRACAO);

ALTER TABLE PROJUDI.PROC_PARTE_INFRACAO ADD CONSTRAINT PK_PROC_PARTE_INFRACAO PRIMARY KEY(ID_PROC_PARTE_INFRACAO);

CREATE INDEX PROJUDI.PROC_PARTE_INFRACAO_IDX2 ON PROJUDI.PROC_PARTE_INFRACAO (ID_PROC_PARTE);

ALTER TABLE PROJUDI.PROC_PARTE_INFRACAO ADD CONSTRAINT PROCPARTEINFRACAO_PROCPARTE_FK FOREIGN KEY (ID_PROC_PARTE) REFERENCES PROJUDI.PROC_PARTE (ID_PROC_PARTE);

CREATE INDEX PROJUDI.PROC_PARTE_INFRACAO_IDX3 ON PROJUDI.PROC_PARTE_INFRACAO (ID_INFRACOES);

ALTER TABLE PROJUDI.PROC_PARTE_INFRACAO ADD CONSTRAINT PROCPARTEINFRACAO_INFRACOES_FK FOREIGN KEY (ID_INFRACOES) REFERENCES PROJUDI.INFRACOES (ID_INFRACOES);

CREATE SEQUENCE  PROJUDI.PROC_PARTE_INFRACAO_ID_SEQ  MINVALUE 1 MAXVALUE 9999999999999999999999 INCREMENT BY 1 START WITH 1 NOCACHE  NOORDER  NOCYCLE;

CREATE OR REPLACE TRIGGER PROJUDI.PROC_PARTE_INFRACAO_ID_TRG BEFORE INSERT OR UPDATE ON PROC_PARTE_INFRACAO
FOR EACH ROW
DECLARE
v_newVal NUMBER(12) := 0;
v_incval NUMBER(12) := 0;
BEGIN
  IF INSERTING AND :new.ID_PROC_PARTE_INFRACAO IS NULL THEN
    SELECT PROC_PARTE_INFRACAO_ID_SEQ.NEXTVAL INTO v_newVal FROM DUAL;
   
   :new.ID_PROC_PARTE_INFRACAO := v_newVal;
  END IF;
END;

ALTER TRIGGER PROJUDI.PROC_PARTE_INFRACAO_ID_TRG ENABLE;