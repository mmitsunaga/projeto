CREATE TABLE PROJUDI.PRISAO_STATUS
(	
   ID_PRISAO_STATUS          NUMBER(10,0)   NOT NULL, 
   PRISAO_STATUS             VARCHAR2(255)  NOT NULL,
   CODIGO_TEMP               NUMBER(10,0),
   CODIGO_EXTERNO            CHAR(1)
);

CREATE UNIQUE INDEX PROJUDI.PRISAO_STATUS_IDX1 ON PROJUDI.PRISAO_STATUS (ID_PRISAO_STATUS);

ALTER TABLE PROJUDI.PRISAO_STATUS ADD CONSTRAINT PK_PRISAO_STATUS PRIMARY KEY(ID_PRISAO_STATUS);

CREATE SEQUENCE  PROJUDI.PRISAO_STATUS_ID_SEQ  MINVALUE 1 MAXVALUE 9999999999999999999999 INCREMENT BY 1 START WITH 4 NOCACHE  NOORDER  NOCYCLE;

CREATE OR REPLACE TRIGGER PROJUDI.PRISAO_STATUS_ID_TRG BEFORE INSERT OR UPDATE ON PRISAO_STATUS
FOR EACH ROW
DECLARE
v_newVal NUMBER(12) := 0;
v_incval NUMBER(12) := 0;
BEGIN
  IF INSERTING AND :new.ID_PRISAO_STATUS IS NULL THEN
    SELECT PRISAO_STATUS_ID_SEQ.NEXTVAL INTO v_newVal FROM DUAL;
   
   :new.ID_PRISAO_STATUS := v_newVal;
  END IF;
END;

ALTER TRIGGER PROJUDI.PRISAO_STATUS_ID_TRG ENABLE;

CREATE OR REPLACE FORCE VIEW PROJUDI.VIEW_PRISAO_STATUS AS 
  SELECT
    PS.ID_PRISAO_STATUS AS ID_PRISAO_STATUS,
    PS.PRISAO_STATUS AS PRISAO_STATUS,    
	PS.CODIGO_TEMP AS CODIGO_TEMP,
	PS.CODIGO_EXTERNO AS CODIGO_EXTERNO
  FROM 
    PROJUDI.PRISAO_STATUS PS;
	
INSERT INTO PROJUDI.PRISAO_STATUS (ID_PRISAO_STATUS, PRISAO_STATUS, CODIGO_TEMP, CODIGO_EXTERNO) VALUES (1, 'preso', NULL, 'P');
INSERT INTO PROJUDI.PRISAO_STATUS (ID_PRISAO_STATUS, PRISAO_STATUS, CODIGO_TEMP, CODIGO_EXTERNO) VALUES (2, 'solto', NULL, 'S');
INSERT INTO PROJUDI.PRISAO_STATUS (ID_PRISAO_STATUS, PRISAO_STATUS, CODIGO_TEMP, CODIGO_EXTERNO) VALUES (3, 'liberdade provis√≥ria', NULL, 'L');
